var yoda=window.yoda||{};yoda.handTracking=function(e,i,t){var a,d,n,o,c="inactive",l=!0;return d=function(){i("body").append('<div class="yoda-panel inactive"></div>'),_yodaPanelInactive=i(".yoda-panel.inactive"),n=i(".yoda-panel"),n.append('<div class="header"><span class="title">Jedi Mode</span><span class="mode">Toggle</span"></div>'),o=i(".yoda-panel .header"),_yodaIndicator=i(".yoda-panel .header .mode"),_bindEvents()},_bindEvents=function(){i(o).on("click",function(){n.hasClass(c)?_jediModeON():_jediModeOFF()})},_jediModeON=function(){n.removeClass(c),l&&(l=!1,_activateTracking())},_activateTracking=function(){function t(){if(compatibility.requestAnimationFrame(t),l.paused&&l.play(),l.readyState===l.HAVE_ENOUGH_DATA&&l.videoWidth>0){if(!d){var i=~~(80*l.videoWidth/l.videoHeight),n=80;d=new objectdetect.detector(i,n,1.1,objectdetect.handfist)}o.width=~~(100*l.videoWidth/l.videoHeight),o.height=100,c.drawImage(l,0,0,o.clientWidth,o.clientHeight);var v=d.detect(l,1);if(v[0]){var h=v[0];h[0]*=l.videoWidth/d.canvas.width,h[1]*=l.videoHeight/d.canvas.height,h[2]*=l.videoWidth/d.canvas.width,h[3]*=l.videoHeight/d.canvas.height;for(var h=v[0],r=v.length-1;r>=0;--r)v[r][4]>h[4]&&(h=v[r]);var s=[h[0]+h[2]/2,h[1]+h[3]/2];if(a){var g=(s[0]-a[0])/l.videoWidth,y=(s[1]-a[1])/l.videoHeight;e.scrollBy(200*g,200*y)}else a=s;c.beginPath(),c.lineWidth="2",c.fillStyle="rgba(255, 255, 255, 0.3)",c.fillRect(h[0]/l.videoWidth*o.clientWidth,h[1]/l.videoHeight*o.clientHeight,h[2]/l.videoWidth*o.clientWidth,h[3]/l.videoHeight*o.clientHeight),c.stroke()}else a=null}}var a,d,o=i('<canvas id="yodaCamera">').get(0),c=o.getContext("2d"),l=document.createElement("video");n.append(o);try{compatibility.getUserMedia({video:!0},function(e){try{l.src=compatibility.URL.createObjectURL(e)}catch(i){l.src=e}compatibility.requestAnimationFrame(t)},function(e){console.log("WebRTC not available")})}catch(v){console.log(v)}},_jediModeOFF=function(){n.addClass(c)},a=function(){console.log("hi"),d()},{init:a}}(this,jQuery,"yoda"),jQuery(yoda.handTracking.init());